define(["exports","./Transforms-f17097e5","./Matrix3-b2351961","./ComponentDatatype-ab629b88","./defaultValue-f6d5e6da","./EllipseGeometryLibrary-d93d7f63","./GeometryAttribute-9c1a6bab","./GeometryAttributes-1e4ddcd2","./GeometryOffsetAttribute-2579b8d2","./IndexDatatype-a9b1bc18","./Math-355606c6"],function(e,t,i,r,a,n,o,s,l,u,d){"use strict";let p=new i.Cartesian3,f=new i.Cartesian3,c=new t.BoundingSphere,m=new t.BoundingSphere;function h(e){let t=(e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT)).center,r=a.defaultValue(e.ellipsoid,i.Ellipsoid.WGS84),n=e.semiMajorAxis,o=e.semiMinorAxis,s=a.defaultValue(e.granularity,d.CesiumMath.RADIANS_PER_DEGREE),l=a.defaultValue(e.height,0),u=a.defaultValue(e.extrudedHeight,l);this._center=i.Cartesian3.clone(t),this._semiMajorAxis=n,this._semiMinorAxis=o,this._ellipsoid=i.Ellipsoid.clone(r),this._rotation=a.defaultValue(e.rotation,0),this._height=Math.max(u,l),this._granularity=s,this._extrudedHeight=Math.min(u,l),this._numberOfVerticalLines=Math.max(a.defaultValue(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}h.packedLength=i.Cartesian3.packedLength+i.Ellipsoid.packedLength+8,h.pack=function(e,t,r){return r=a.defaultValue(r,0),i.Cartesian3.pack(e._center,t,r),r+=i.Cartesian3.packedLength,i.Ellipsoid.pack(e._ellipsoid,t,r),r+=i.Ellipsoid.packedLength,t[r++]=e._semiMajorAxis,t[r++]=e._semiMinorAxis,t[r++]=e._rotation,t[r++]=e._height,t[r++]=e._granularity,t[r++]=e._extrudedHeight,t[r++]=e._numberOfVerticalLines,t[r]=a.defaultValue(e._offsetAttribute,-1),t};let b=new i.Cartesian3,y=new i.Ellipsoid,A={center:b,ellipsoid:y,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};h.unpack=function(e,t,r){t=a.defaultValue(t,0);let n=i.Cartesian3.unpack(e,t,b);t+=i.Cartesian3.packedLength;let o=i.Ellipsoid.unpack(e,t,y);t+=i.Ellipsoid.packedLength;let s=e[t++],l=e[t++],u=e[t++],d=e[t++],p=e[t++],f=e[t++],c=e[t++],m=e[t];return a.defined(r)?(r._center=i.Cartesian3.clone(n,r._center),r._ellipsoid=i.Ellipsoid.clone(o,r._ellipsoid),r._semiMajorAxis=s,r._semiMinorAxis=l,r._rotation=u,r._height=d,r._granularity=p,r._extrudedHeight=f,r._numberOfVerticalLines=c,r._offsetAttribute=-1===m?void 0:m,r):(A.height=d,A.extrudedHeight=f,A.granularity=p,A.rotation=u,A.semiMajorAxis=s,A.semiMinorAxis=l,A.numberOfVerticalLines=c,A.offsetAttribute=-1===m?void 0:m,new h(A))},h.createGeometry=function(e){let h;if(e._semiMajorAxis<=0||e._semiMinorAxis<=0)return;let b=e._height,y=e._extrudedHeight,A=!d.CesiumMath.equalsEpsilon(b,y,0,d.CesiumMath.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);let _={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:b,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};if(A)_.extrudedHeight=y,_.offsetAttribute=e._offsetAttribute,h=function(e){let f=e.center,h=e.ellipsoid,b=e.semiMajorAxis,y=i.Cartesian3.multiplyByScalar(h.geodeticSurfaceNormal(f,p),e.height,p);c.center=i.Cartesian3.add(f,y,c.center),c.radius=b,y=i.Cartesian3.multiplyByScalar(h.geodeticSurfaceNormal(f,y),e.extrudedHeight,y),m.center=i.Cartesian3.add(f,y,m.center),m.radius=b;let A=n.EllipseGeometryLibrary.computeEllipsePositions(e,!1,!0).outerPositions,_=new s.GeometryAttributes({position:new o.GeometryAttribute({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n.EllipseGeometryLibrary.raisePositionsToHeight(A,e,!0)})});A=_.position.values;let g=t.BoundingSphere.union(c,m),x=A.length/3;if(a.defined(e.offsetAttribute)){let t=new Uint8Array(x);if(e.offsetAttribute===l.GeometryOffsetAttribute.TOP)t=t.fill(1,0,x/2);else{let i=e.offsetAttribute===l.GeometryOffsetAttribute.NONE?0:1;t=t.fill(i)}_.applyOffset=new o.GeometryAttribute({componentDatatype:r.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let E=a.defaultValue(e.numberOfVerticalLines,16);E=d.CesiumMath.clamp(E,0,x/2);let M=u.IndexDatatype.createTypedArray(x,2*x+2*E);x/=2;let C,G,L=0;for(C=0;C<x;++C)M[L++]=C,M[L++]=(C+1)%x,M[L++]=C+x,M[L++]=(C+1)%x+x;if(E>0){let e=Math.min(E,x);G=Math.round(x/e);let t=Math.min(G*E,x);for(C=0;C<t;C+=G)M[L++]=C,M[L++]=C+x}return{boundingSphere:g,attributes:_,indices:M}}(_);else if(h=function(e){let a=e.center;f=i.Cartesian3.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(a,f),e.height,f),f=i.Cartesian3.add(a,f,f);let l=new t.BoundingSphere(f,e.semiMajorAxis),d=n.EllipseGeometryLibrary.computeEllipsePositions(e,!1,!0).outerPositions,p=new s.GeometryAttributes({position:new o.GeometryAttribute({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n.EllipseGeometryLibrary.raisePositionsToHeight(d,e,!1)})}),c=d.length/3,m=u.IndexDatatype.createTypedArray(c,2*c),h=0;for(let e=0;e<c;++e)m[h++]=e,m[h++]=(e+1)%c;return{boundingSphere:l,attributes:p,indices:m}}(_),a.defined(e._offsetAttribute)){let t=h.attributes.position.values.length,i=e._offsetAttribute===l.GeometryOffsetAttribute.NONE?0:1,a=new Uint8Array(t/3).fill(i);h.attributes.applyOffset=new o.GeometryAttribute({componentDatatype:r.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:a})}return new o.Geometry({attributes:h.attributes,indices:h.indices,primitiveType:o.PrimitiveType.LINES,boundingSphere:h.boundingSphere,offsetAttribute:e._offsetAttribute})},e.EllipseOutlineGeometry=h});