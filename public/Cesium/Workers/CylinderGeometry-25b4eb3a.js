define(["exports","./Transforms-f17097e5","./Matrix2-7a8e9daf","./Matrix3-b2351961","./ComponentDatatype-ab629b88","./CylinderGeometryLibrary-4d7f606d","./defaultValue-f6d5e6da","./GeometryAttribute-9c1a6bab","./GeometryAttributes-1e4ddcd2","./GeometryOffsetAttribute-2579b8d2","./IndexDatatype-a9b1bc18","./Math-355606c6","./VertexFormat-fbdec922"],function(t,e,a,n,r,o,i,s,u,m,l,d,f){"use strict";let p;let y=new a.Cartesian2,b=new n.Cartesian3,c=new n.Cartesian3,A=new n.Cartesian3,x=new n.Cartesian3;function g(t){let e=(t=i.defaultValue(t,i.defaultValue.EMPTY_OBJECT)).length,a=t.topRadius,n=t.bottomRadius,r=i.defaultValue(t.vertexFormat,f.VertexFormat.DEFAULT),o=i.defaultValue(t.slices,128);this._length=e,this._topRadius=a,this._bottomRadius=n,this._vertexFormat=f.VertexFormat.clone(r),this._slices=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}g.packedLength=f.VertexFormat.packedLength+5,g.pack=function(t,e,a){return a=i.defaultValue(a,0),f.VertexFormat.pack(t._vertexFormat,e,a),a+=f.VertexFormat.packedLength,e[a++]=t._length,e[a++]=t._topRadius,e[a++]=t._bottomRadius,e[a++]=t._slices,e[a]=i.defaultValue(t._offsetAttribute,-1),e};let _=new f.VertexFormat,h={vertexFormat:_,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};g.unpack=function(t,e,a){e=i.defaultValue(e,0);let n=f.VertexFormat.unpack(t,e,_);e+=f.VertexFormat.packedLength;let r=t[e++],o=t[e++],s=t[e++],u=t[e++],m=t[e];return i.defined(a)?(a._vertexFormat=f.VertexFormat.clone(n,a._vertexFormat),a._length=r,a._topRadius=o,a._bottomRadius=s,a._slices=u,a._offsetAttribute=-1===m?void 0:m,a):(h.length=r,h.topRadius=o,h.bottomRadius=s,h.slices=u,h.offsetAttribute=-1===m?void 0:m,new g(h))},g.createGeometry=function(t){let f,p=t._length,g=t._topRadius,_=t._bottomRadius,h=t._vertexFormat,F=t._slices;if(p<=0||g<0||_<0||0===g&&0===_)return;let v=F+F,C=F+v,w=v+v,G=o.CylinderGeometryLibrary.computePositions(p,g,_,F,!0),V=h.st?new Float32Array(2*w):void 0,D=h.normal?new Float32Array(3*w):void 0,R=h.tangent?new Float32Array(3*w):void 0,T=h.bitangent?new Float32Array(3*w):void 0,O=h.normal||h.tangent||h.bitangent;if(O){let t=h.tangent||h.bitangent,e=0,a=0,r=0,o=Math.atan2(_-g,p);b.z=Math.sin(o);let i=Math.cos(o),s=A,u=c;for(f=0;f<F;f++){let o=f/F*d.CesiumMath.TWO_PI,m=i*Math.cos(o),l=i*Math.sin(o);O&&(b.x=m,b.y=l,t&&(s=n.Cartesian3.normalize(n.Cartesian3.cross(n.Cartesian3.UNIT_Z,b,s),s)),h.normal&&(D[e++]=b.x,D[e++]=b.y,D[e++]=b.z,D[e++]=b.x,D[e++]=b.y,D[e++]=b.z),h.tangent&&(R[a++]=s.x,R[a++]=s.y,R[a++]=s.z,R[a++]=s.x,R[a++]=s.y,R[a++]=s.z),h.bitangent&&(u=n.Cartesian3.normalize(n.Cartesian3.cross(b,s,u),u),T[r++]=u.x,T[r++]=u.y,T[r++]=u.z,T[r++]=u.x,T[r++]=u.y,T[r++]=u.z))}for(f=0;f<F;f++)h.normal&&(D[e++]=0,D[e++]=0,D[e++]=-1),h.tangent&&(R[a++]=1,R[a++]=0,R[a++]=0),h.bitangent&&(T[r++]=0,T[r++]=-1,T[r++]=0);for(f=0;f<F;f++)h.normal&&(D[e++]=0,D[e++]=0,D[e++]=1),h.tangent&&(R[a++]=1,R[a++]=0,R[a++]=0),h.bitangent&&(T[r++]=0,T[r++]=1,T[r++]=0)}let L=12*F-12,M=l.IndexDatatype.createTypedArray(w,L),P=0,k=0;for(f=0;f<F-1;f++)M[P++]=k,M[P++]=k+2,M[P++]=k+3,M[P++]=k,M[P++]=k+3,M[P++]=k+1,k+=2;for(M[P++]=v-2,M[P++]=0,M[P++]=1,M[P++]=v-2,M[P++]=1,M[P++]=v-1,f=1;f<F-1;f++)M[P++]=v+f+1,M[P++]=v+f,M[P++]=v;for(f=1;f<F-1;f++)M[P++]=C,M[P++]=C+f,M[P++]=C+f+1;let z=0;if(h.st){let t=Math.max(g,_);for(f=0;f<w;f++){let e=n.Cartesian3.fromArray(G,3*f,x);V[z++]=(e.x+t)/(2*t),V[z++]=(e.y+t)/(2*t)}}let E=new u.GeometryAttributes;h.position&&(E.position=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:G})),h.normal&&(E.normal=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),h.tangent&&(E.tangent=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),h.bitangent&&(E.bitangent=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:T})),h.st&&(E.st=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:V})),y.x=.5*p,y.y=Math.max(_,g);let N=new e.BoundingSphere(n.Cartesian3.ZERO,a.Cartesian2.magnitude(y));if(i.defined(t._offsetAttribute)){p=G.length;let e=t._offsetAttribute===m.GeometryOffsetAttribute.NONE?0:1,a=new Uint8Array(p/3).fill(e);E.applyOffset=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:a})}return new s.Geometry({attributes:E,indices:M,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:N,offsetAttribute:t._offsetAttribute})},g.getUnitCylinder=function(){return i.defined(p)||(p=g.createGeometry(new g({topRadius:1,bottomRadius:1,length:1,vertexFormat:f.VertexFormat.POSITION_ONLY}))),p},t.CylinderGeometry=g});