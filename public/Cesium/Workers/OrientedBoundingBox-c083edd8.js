define(["exports","./Transforms-f17097e5","./Matrix2-7a8e9daf","./Matrix3-b2351961","./defaultValue-f6d5e6da","./EllipsoidTangentPlane-c3e9d965","./Math-355606c6","./Plane-5931b53e"],function(a,t,e,n,r,i,s,o){"use strict";function C(a,t){this.center=n.Cartesian3.clone(r.defaultValue(a,n.Cartesian3.ZERO)),this.halfAxes=n.Matrix3.clone(r.defaultValue(t,n.Matrix3.ZERO))}C.packedLength=n.Cartesian3.packedLength+n.Matrix3.packedLength,C.pack=function(a,t,e){return e=r.defaultValue(e,0),n.Cartesian3.pack(a.center,t,e),n.Matrix3.pack(a.halfAxes,t,e+n.Cartesian3.packedLength),t},C.unpack=function(a,t,e){return t=r.defaultValue(t,0),r.defined(e)||(e=new C),n.Cartesian3.unpack(a,t,e.center),n.Matrix3.unpack(a,t+n.Cartesian3.packedLength,e.halfAxes),e};let l=new n.Cartesian3,c=new n.Cartesian3,u=new n.Cartesian3,d=new n.Cartesian3,h=new n.Cartesian3,x=new n.Cartesian3,m=new n.Matrix3,M={unitary:new n.Matrix3,diagonal:new n.Matrix3};C.fromPoints=function(a,t){let e;if(r.defined(t)||(t=new C),!r.defined(a)||0===a.length)return t.halfAxes=n.Matrix3.ZERO,t.center=n.Cartesian3.ZERO,t;let i=a.length,s=n.Cartesian3.clone(a[0],l);for(e=1;e<i;e++)n.Cartesian3.add(s,a[e],s);let o=1/i;n.Cartesian3.multiplyByScalar(s,o,s);let f,p=0,w=0,g=0,y=0,b=0,N=0;for(e=0;e<i;e++)p+=(f=n.Cartesian3.subtract(a[e],s,c)).x*f.x,w+=f.x*f.y,g+=f.x*f.z,y+=f.y*f.y,b+=f.y*f.z,N+=f.z*f.z;p*=o,w*=o,g*=o,y*=o,b*=o,N*=o,m[0]=p,m[1]=w,m[2]=g,m[3]=w,m[4]=y,m[5]=b,m[6]=g,m[7]=b,m[8]=N;let T=n.Matrix3.computeEigenDecomposition(m,M),O=n.Matrix3.clone(T.unitary,t.halfAxes),A=n.Matrix3.getColumn(O,0,d),P=n.Matrix3.getColumn(O,1,h),I=n.Matrix3.getColumn(O,2,x),R=-Number.MAX_VALUE,E=-Number.MAX_VALUE,S=-Number.MAX_VALUE,U=Number.MAX_VALUE,L=Number.MAX_VALUE,z=Number.MAX_VALUE;for(e=0;e<i;e++)f=a[e],R=Math.max(n.Cartesian3.dot(A,f),R),E=Math.max(n.Cartesian3.dot(P,f),E),S=Math.max(n.Cartesian3.dot(I,f),S),U=Math.min(n.Cartesian3.dot(A,f),U),L=Math.min(n.Cartesian3.dot(P,f),L),z=Math.min(n.Cartesian3.dot(I,f),z);A=n.Cartesian3.multiplyByScalar(A,.5*(U+R),A),P=n.Cartesian3.multiplyByScalar(P,.5*(L+E),P),I=n.Cartesian3.multiplyByScalar(I,.5*(z+S),I);let B=n.Cartesian3.add(A,P,t.center);return n.Cartesian3.add(B,I,B),u.x=R-U,u.y=E-L,u.z=S-z,n.Cartesian3.multiplyByScalar(u,.5,u),n.Matrix3.multiplyByScale(t.halfAxes,u,t.halfAxes),t};let f=new n.Cartesian3,p=new n.Cartesian3;function w(a,t,e,i,s,o,l,c,u,d,h){r.defined(h)||(h=new C);let x=h.halfAxes;n.Matrix3.setColumn(x,0,t,x),n.Matrix3.setColumn(x,1,e,x),n.Matrix3.setColumn(x,2,i,x);let m=f;m.x=(s+o)/2,m.y=(l+c)/2,m.z=(u+d)/2,p.x=(o-s)/2,p.y=(c-l)/2,p.z=(d-u)/2;let M=h.center;return m=n.Matrix3.multiplyByVector(x,m,m),n.Cartesian3.add(a,m,M),n.Matrix3.multiplyByScale(x,p,x),h}let g=new n.Cartographic,y=new n.Cartesian3,b=new n.Cartographic,N=new n.Cartographic,T=new n.Cartographic,O=new n.Cartographic,A=new n.Cartographic,P=new n.Cartesian3,I=new n.Cartesian3,R=new n.Cartesian3,E=new n.Cartesian3,S=new n.Cartesian3,U=new e.Cartesian2,L=new e.Cartesian2,z=new e.Cartesian2,B=new e.Cartesian2,V=new e.Cartesian2,_=new n.Cartesian3,k=new n.Cartesian3,W=new n.Cartesian3,X=new n.Cartesian3,q=new e.Cartesian2,D=new n.Cartesian3,j=new n.Cartesian3,Z=new n.Cartesian3,v=new o.Plane(n.Cartesian3.UNIT_X,0);C.fromRectangle=function(a,t,C,l,c){let u,d,h,x,m,M,f;if(t=r.defaultValue(t,0),C=r.defaultValue(C,0),l=r.defaultValue(l,n.Ellipsoid.WGS84),a.width<=s.CesiumMath.PI){let r=e.Rectangle.center(a,g),s=l.cartographicToCartesian(r,y),p=new i.EllipsoidTangentPlane(s,l);f=p.plane;let _=r.longitude,k=a.south<0&&a.north>0?0:r.latitude,W=n.Cartographic.fromRadians(_,a.north,C,b),X=n.Cartographic.fromRadians(a.west,a.north,C,N),q=n.Cartographic.fromRadians(a.west,k,C,T),D=n.Cartographic.fromRadians(a.west,a.south,C,O),j=n.Cartographic.fromRadians(_,a.south,C,A),Z=l.cartographicToCartesian(W,P),v=l.cartographicToCartesian(X,I),Y=l.cartographicToCartesian(q,R),G=l.cartographicToCartesian(D,E),F=l.cartographicToCartesian(j,S),H=p.projectPointToNearestOnPlane(Z,U),J=p.projectPointToNearestOnPlane(v,L),K=p.projectPointToNearestOnPlane(Y,z),Q=p.projectPointToNearestOnPlane(G,B),$=p.projectPointToNearestOnPlane(F,V);return d=-(u=Math.min(J.x,K.x,Q.x)),x=Math.max(J.y,H.y),h=Math.min(Q.y,$.y),X.height=D.height=t,v=l.cartographicToCartesian(X,I),G=l.cartographicToCartesian(D,E),m=Math.min(o.Plane.getPointDistance(f,v),o.Plane.getPointDistance(f,G)),M=C,w(p.origin,p.xAxis,p.yAxis,p.zAxis,u,d,h,x,m,M,c)}let p=a.south>0,Y=a.north<0,G=p?a.south:Y?a.north:0,F=e.Rectangle.center(a,g).longitude,H=n.Cartesian3.fromRadians(F,G,C,l,_);H.z=0;let J=Math.abs(H.x)<s.CesiumMath.EPSILON10&&Math.abs(H.y)<s.CesiumMath.EPSILON10?n.Cartesian3.UNIT_X:n.Cartesian3.normalize(H,k),K=n.Cartesian3.UNIT_Z,Q=n.Cartesian3.cross(J,K,W);f=o.Plane.fromPointNormal(H,J,v);let $=n.Cartesian3.fromRadians(F+s.CesiumMath.PI_OVER_TWO,G,C,l,X);u=-(d=n.Cartesian3.dot(o.Plane.projectPointOntoPlane(f,$,q),Q)),x=n.Cartesian3.fromRadians(0,a.north,Y?t:C,l,D).z,h=n.Cartesian3.fromRadians(0,a.south,p?t:C,l,j).z;let aa=n.Cartesian3.fromRadians(a.east,G,C,l,Z);return m=o.Plane.getPointDistance(f,aa),w(H,Q,K,J,u,d,h,x,m,M=0,c)},C.fromTransformation=function(a,t){return r.defined(t)||(t=new C),t.center=e.Matrix4.getTranslation(a,t.center),t.halfAxes=e.Matrix4.getMatrix3(a,t.halfAxes),t.halfAxes=n.Matrix3.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t},C.clone=function(a,t){if(r.defined(a))return r.defined(t)?(n.Cartesian3.clone(a.center,t.center),n.Matrix3.clone(a.halfAxes,t.halfAxes),t):new C(a.center,a.halfAxes)},C.intersectPlane=function(a,e){let r=a.center,i=e.normal,s=a.halfAxes,o=i.x,C=i.y,l=i.z,c=Math.abs(o*s[n.Matrix3.COLUMN0ROW0]+C*s[n.Matrix3.COLUMN0ROW1]+l*s[n.Matrix3.COLUMN0ROW2])+Math.abs(o*s[n.Matrix3.COLUMN1ROW0]+C*s[n.Matrix3.COLUMN1ROW1]+l*s[n.Matrix3.COLUMN1ROW2])+Math.abs(o*s[n.Matrix3.COLUMN2ROW0]+C*s[n.Matrix3.COLUMN2ROW1]+l*s[n.Matrix3.COLUMN2ROW2]),u=n.Cartesian3.dot(i,r)+e.distance;return u<=-c?t.Intersect.OUTSIDE:u>=c?t.Intersect.INSIDE:t.Intersect.INTERSECTING};let Y=new n.Cartesian3,G=new n.Cartesian3,F=new n.Cartesian3,H=new n.Cartesian3,J=new n.Cartesian3,K=new n.Cartesian3;C.distanceSquaredTo=function(a,t){let e,r,i;let o=n.Cartesian3.subtract(t,a.center,f),C=a.halfAxes,l=n.Matrix3.getColumn(C,0,Y),c=n.Matrix3.getColumn(C,1,G),u=n.Matrix3.getColumn(C,2,F),d=n.Cartesian3.magnitude(l),h=n.Cartesian3.magnitude(c),x=n.Cartesian3.magnitude(u),m=!0,M=!0,p=!0;d>0?n.Cartesian3.divideByScalar(l,d,l):m=!1,h>0?n.Cartesian3.divideByScalar(c,h,c):M=!1,x>0?n.Cartesian3.divideByScalar(u,x,u):p=!1;let w=!m+!M+!p;if(1===w){let a=l;e=c,r=u,M?p||(a=u,r=l):(a=c,e=l),i=n.Cartesian3.cross(e,r,J),a===l?l=i:a===c?c=i:a===u&&(u=i)}else if(2===w){e=l,M?e=c:p&&(e=u);let a=n.Cartesian3.UNIT_Y;a.equalsEpsilon(e,s.CesiumMath.EPSILON3)&&(a=n.Cartesian3.UNIT_X),r=n.Cartesian3.cross(e,a,H),n.Cartesian3.normalize(r,r),i=n.Cartesian3.cross(e,r,J),n.Cartesian3.normalize(i,i),e===l?(c=r,u=i):e===c?(u=r,l=i):e===u&&(l=r,c=i)}else 3===w&&(l=n.Cartesian3.UNIT_X,c=n.Cartesian3.UNIT_Y,u=n.Cartesian3.UNIT_Z);K.x=n.Cartesian3.dot(o,l),K.y=n.Cartesian3.dot(o,c),K.z=n.Cartesian3.dot(o,u);let g,y=0;return K.x<-d?y+=(g=K.x+d)*g:K.x>d&&(y+=(g=K.x-d)*g),K.y<-h?y+=(g=K.y+h)*g:K.y>h&&(y+=(g=K.y-h)*g),K.z<-x?y+=(g=K.z+x)*g:K.z>x&&(y+=(g=K.z-x)*g),y};let Q=new n.Cartesian3,$=new n.Cartesian3;C.computePlaneDistances=function(a,e,i,s){r.defined(s)||(s=new t.Interval);let o=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,l=a.center,c=a.halfAxes,u=n.Matrix3.getColumn(c,0,Y),d=n.Matrix3.getColumn(c,1,G),h=n.Matrix3.getColumn(c,2,F),x=n.Cartesian3.add(u,d,Q);n.Cartesian3.add(x,h,x),n.Cartesian3.add(x,l,x);let m=n.Cartesian3.subtract(x,e,$),M=n.Cartesian3.dot(i,m);return o=Math.min(M,o),C=Math.max(M,C),n.Cartesian3.add(l,u,x),n.Cartesian3.add(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),o=Math.min(M=n.Cartesian3.dot(i,m),o),C=Math.max(M,C),n.Cartesian3.add(l,u,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,e,m),o=Math.min(M=n.Cartesian3.dot(i,m),o),C=Math.max(M,C),n.Cartesian3.add(l,u,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),o=Math.min(M=n.Cartesian3.dot(i,m),o),C=Math.max(M,C),n.Cartesian3.subtract(l,u,x),n.Cartesian3.add(x,d,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,e,m),o=Math.min(M=n.Cartesian3.dot(i,m),o),C=Math.max(M,C),n.Cartesian3.subtract(l,u,x),n.Cartesian3.add(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),o=Math.min(M=n.Cartesian3.dot(i,m),o),C=Math.max(M,C),n.Cartesian3.subtract(l,u,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,e,m),o=Math.min(M=n.Cartesian3.dot(i,m),o),C=Math.max(M,C),n.Cartesian3.subtract(l,u,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),o=Math.min(M=n.Cartesian3.dot(i,m),o),C=Math.max(M,C),s.start=o,s.stop=C,s};let aa=new n.Cartesian3,at=new n.Cartesian3,ae=new n.Cartesian3;C.computeCorners=function(a,t){r.defined(t)||(t=[new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3]);let e=a.center,i=a.halfAxes,s=n.Matrix3.getColumn(i,0,aa),o=n.Matrix3.getColumn(i,1,at),C=n.Matrix3.getColumn(i,2,ae);return n.Cartesian3.clone(e,t[0]),n.Cartesian3.subtract(t[0],s,t[0]),n.Cartesian3.subtract(t[0],o,t[0]),n.Cartesian3.subtract(t[0],C,t[0]),n.Cartesian3.clone(e,t[1]),n.Cartesian3.subtract(t[1],s,t[1]),n.Cartesian3.subtract(t[1],o,t[1]),n.Cartesian3.add(t[1],C,t[1]),n.Cartesian3.clone(e,t[2]),n.Cartesian3.subtract(t[2],s,t[2]),n.Cartesian3.add(t[2],o,t[2]),n.Cartesian3.subtract(t[2],C,t[2]),n.Cartesian3.clone(e,t[3]),n.Cartesian3.subtract(t[3],s,t[3]),n.Cartesian3.add(t[3],o,t[3]),n.Cartesian3.add(t[3],C,t[3]),n.Cartesian3.clone(e,t[4]),n.Cartesian3.add(t[4],s,t[4]),n.Cartesian3.subtract(t[4],o,t[4]),n.Cartesian3.subtract(t[4],C,t[4]),n.Cartesian3.clone(e,t[5]),n.Cartesian3.add(t[5],s,t[5]),n.Cartesian3.subtract(t[5],o,t[5]),n.Cartesian3.add(t[5],C,t[5]),n.Cartesian3.clone(e,t[6]),n.Cartesian3.add(t[6],s,t[6]),n.Cartesian3.add(t[6],o,t[6]),n.Cartesian3.subtract(t[6],C,t[6]),n.Cartesian3.clone(e,t[7]),n.Cartesian3.add(t[7],s,t[7]),n.Cartesian3.add(t[7],o,t[7]),n.Cartesian3.add(t[7],C,t[7]),t};let an=new n.Matrix3;C.computeTransformation=function(a,t){r.defined(t)||(t=new e.Matrix4);let i=a.center,s=n.Matrix3.multiplyByUniformScale(a.halfAxes,2,an);return e.Matrix4.fromRotationTranslation(s,i,t)};let ar=new t.BoundingSphere;C.isOccluded=function(a,e){let n=t.BoundingSphere.fromOrientedBoundingBox(a,ar);return!e.isBoundingSphereVisible(n)},C.prototype.intersectPlane=function(a){return C.intersectPlane(this,a)},C.prototype.distanceSquaredTo=function(a){return C.distanceSquaredTo(this,a)},C.prototype.computePlaneDistances=function(a,t,e){return C.computePlaneDistances(this,a,t,e)},C.prototype.computeCorners=function(a){return C.computeCorners(this,a)},C.prototype.computeTransformation=function(a){return C.computeTransformation(this,a)},C.prototype.isOccluded=function(a){return C.isOccluded(this,a)},C.equals=function(a,t){return a===t||r.defined(a)&&r.defined(t)&&n.Cartesian3.equals(a.center,t.center)&&n.Matrix3.equals(a.halfAxes,t.halfAxes)},C.prototype.clone=function(a){return C.clone(this,a)},C.prototype.equals=function(a){return C.equals(this,a)},a.OrientedBoundingBox=C});