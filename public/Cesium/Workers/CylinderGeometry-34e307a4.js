define(["exports","./GeometryOffsetAttribute-1772960d","./Transforms-d13cc04e","./Matrix2-9aa31791","./ComponentDatatype-93750d1a","./CylinderGeometryLibrary-dc0b434b","./when-4bbc8319","./RuntimeError-346a3079","./GeometryAttribute-43536dc0","./GeometryAttributes-7827a6c2","./IndexDatatype-b7d979a6","./VertexFormat-71718faa"],function(t,e,a,r,n,o,i,s,m,u,d,p){"use strict";var y=new r.Cartesian2,l=new r.Cartesian3,f=new r.Cartesian3,b=new r.Cartesian3,c=new r.Cartesian3;function v(t){var e=(t=i.defaultValue(t,i.defaultValue.EMPTY_OBJECT)).length,a=t.topRadius,r=t.bottomRadius,n=i.defaultValue(t.vertexFormat,p.VertexFormat.DEFAULT),o=i.defaultValue(t.slices,128);this._length=e,this._topRadius=a,this._bottomRadius=r,this._vertexFormat=p.VertexFormat.clone(n),this._slices=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}v.packedLength=p.VertexFormat.packedLength+5,v.pack=function(t,e,a){return a=i.defaultValue(a,0),p.VertexFormat.pack(t._vertexFormat,e,a),a+=p.VertexFormat.packedLength,e[a++]=t._length,e[a++]=t._topRadius,e[a++]=t._bottomRadius,e[a++]=t._slices,e[a]=i.defaultValue(t._offsetAttribute,-1),e};var A,x=new p.VertexFormat,g={vertexFormat:x,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};v.unpack=function(t,e,a){e=i.defaultValue(e,0);var r=p.VertexFormat.unpack(t,e,x);e+=p.VertexFormat.packedLength;var n=t[e++],o=t[e++],s=t[e++],m=t[e++],u=t[e];return i.defined(a)?(a._vertexFormat=p.VertexFormat.clone(r,a._vertexFormat),a._length=n,a._topRadius=o,a._bottomRadius=s,a._slices=m,a._offsetAttribute=-1===u?void 0:u,a):(g.length=n,g.topRadius=o,g.bottomRadius=s,g.slices=m,g.offsetAttribute=-1===u?void 0:u,new v(g))},v.createGeometry=function(t){var s=t._length,p=t._topRadius,v=t._bottomRadius,A=t._vertexFormat,x=t._slices;if(!(s<=0||p<0||v<0||0===p&&0===v)){var g,_=x+x,h=x+_,F=_+_,C=o.CylinderGeometryLibrary.computePositions(s,p,v,x,!0),w=A.st?new Float32Array(2*F):void 0,G=A.normal?new Float32Array(3*F):void 0,R=A.tangent?new Float32Array(3*F):void 0,D=A.bitangent?new Float32Array(3*F):void 0,V=A.normal||A.tangent||A.bitangent;if(V){var T=A.tangent||A.bitangent,O=0,L=0,P=0,E=Math.atan2(v-p,s);l.z=Math.sin(E);var M=Math.cos(E),k=b,z=f;for(g=0;g<x;g++){var N=g/x*n.CesiumMath.TWO_PI,I=M*Math.cos(N),U=M*Math.sin(N);V&&(l.x=I,l.y=U,T&&(k=r.Cartesian3.normalize(r.Cartesian3.cross(r.Cartesian3.UNIT_Z,l,k),k)),A.normal&&(G[O++]=l.x,G[O++]=l.y,G[O++]=l.z,G[O++]=l.x,G[O++]=l.y,G[O++]=l.z),A.tangent&&(R[L++]=k.x,R[L++]=k.y,R[L++]=k.z,R[L++]=k.x,R[L++]=k.y,R[L++]=k.z),A.bitangent&&(z=r.Cartesian3.normalize(r.Cartesian3.cross(l,k,z),z),D[P++]=z.x,D[P++]=z.y,D[P++]=z.z,D[P++]=z.x,D[P++]=z.y,D[P++]=z.z))}for(g=0;g<x;g++)A.normal&&(G[O++]=0,G[O++]=0,G[O++]=-1),A.tangent&&(R[L++]=1,R[L++]=0,R[L++]=0),A.bitangent&&(D[P++]=0,D[P++]=-1,D[P++]=0);for(g=0;g<x;g++)A.normal&&(G[O++]=0,G[O++]=0,G[O++]=1),A.tangent&&(R[L++]=1,R[L++]=0,R[L++]=0),A.bitangent&&(D[P++]=0,D[P++]=1,D[P++]=0)}var S=12*x-12,B=d.IndexDatatype.createTypedArray(F,S),Y=0,Z=0;for(g=0;g<x-1;g++)B[Y++]=Z,B[Y++]=Z+2,B[Y++]=Z+3,B[Y++]=Z,B[Y++]=Z+3,B[Y++]=Z+1,Z+=2;for(B[Y++]=_-2,B[Y++]=0,B[Y++]=1,B[Y++]=_-2,B[Y++]=1,B[Y++]=_-1,g=1;g<x-1;g++)B[Y++]=_+g+1,B[Y++]=_+g,B[Y++]=_;for(g=1;g<x-1;g++)B[Y++]=h,B[Y++]=h+g,B[Y++]=h+g+1;var J=0;if(A.st){var W=Math.max(p,v);for(g=0;g<F;g++){var j=r.Cartesian3.fromArray(C,3*g,c);w[J++]=(j.x+W)/(2*W),w[J++]=(j.y+W)/(2*W)}}var q=new u.GeometryAttributes;A.position&&(q.position=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:C})),A.normal&&(q.normal=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:G})),A.tangent&&(q.tangent=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),A.bitangent&&(q.bitangent=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),A.st&&(q.st=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:w})),y.x=.5*s,y.y=Math.max(v,p);var H=new a.BoundingSphere(r.Cartesian3.ZERO,r.Cartesian2.magnitude(y));if(i.defined(t._offsetAttribute)){s=C.length;var K=new Uint8Array(s/3),Q=t._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;e.arrayFill(K,Q),q.applyOffset=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:K})}return new m.Geometry({attributes:q,indices:B,primitiveType:m.PrimitiveType.TRIANGLES,boundingSphere:H,offsetAttribute:t._offsetAttribute})}},v.getUnitCylinder=function(){return i.defined(A)||(A=v.createGeometry(new v({topRadius:1,bottomRadius:1,length:1,vertexFormat:p.VertexFormat.POSITION_ONLY}))),A},t.CylinderGeometry=v});