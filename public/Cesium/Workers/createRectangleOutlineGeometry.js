define(["./defaultValue-f6d5e6da","./Matrix3-b2351961","./Matrix2-7a8e9daf","./Transforms-f17097e5","./ComponentDatatype-ab629b88","./GeometryAttribute-9c1a6bab","./GeometryAttributes-1e4ddcd2","./GeometryOffsetAttribute-2579b8d2","./IndexDatatype-a9b1bc18","./Math-355606c6","./PolygonPipeline-3fa47499","./RectangleGeometryLibrary-6ad7ff7a","./RuntimeError-9b4ce3fb","./combine-0c102d93","./WebGLConstants-7f557f93","./EllipsoidRhumbLine-1289f7e8"],function(e,t,i,n,a,o,r,l,u,s,d,p,c,f,g,h){"use strict";let y=new n.BoundingSphere,b=new n.BoundingSphere,m=new t.Cartesian3,_=new i.Rectangle;function E(e,t){let i=e._ellipsoid,n=t.height,l=t.width,s=t.northCap,d=t.southCap,c=n,f=2,g=0,h=4;s&&(f-=1,c-=1,g+=1,h-=2),d&&(f-=1,c-=1,g+=1,h-=2),g+=f*l+2*c-h;let y=new Float64Array(3*g),b,_=0,E=0;if(s)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,0,m),y[_++]=m.x,y[_++]=m.y,y[_++]=m.z;else for(b=0;b<l;b++)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,b,m),y[_++]=m.x,y[_++]=m.y,y[_++]=m.z;for(b=l-1,E=1;E<n;E++)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,b,m),y[_++]=m.x,y[_++]=m.y,y[_++]=m.z;if(E=n-1,!d)for(b=l-2;b>=0;b--)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,b,m),y[_++]=m.x,y[_++]=m.y,y[_++]=m.z;for(b=0,E=n-2;E>0;E--)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,b,m),y[_++]=m.x,y[_++]=m.y,y[_++]=m.z;let A=y.length/3*2,G=u.IndexDatatype.createTypedArray(y.length/3,A),R=0;for(let e=0;e<y.length/3-1;e++)G[R++]=e,G[R++]=e+1;G[R++]=y.length/3-1,G[R++]=0;let P=new o.Geometry({attributes:new r.GeometryAttributes,primitiveType:o.PrimitiveType.LINES});return P.attributes.position=new o.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y}),P.indices=G,P}function A(n){let a=(n=e.defaultValue(n,e.defaultValue.EMPTY_OBJECT)).rectangle,o=e.defaultValue(n.granularity,s.CesiumMath.RADIANS_PER_DEGREE),r=e.defaultValue(n.ellipsoid,t.Ellipsoid.WGS84),l=e.defaultValue(n.rotation,0),u=e.defaultValue(n.height,0),d=e.defaultValue(n.extrudedHeight,u);this._rectangle=i.Rectangle.clone(a),this._granularity=o,this._ellipsoid=r,this._surfaceHeight=Math.max(u,d),this._rotation=l,this._extrudedHeight=Math.min(u,d),this._offsetAttribute=n.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}A.packedLength=i.Rectangle.packedLength+t.Ellipsoid.packedLength+5,A.pack=function(n,a,o){return o=e.defaultValue(o,0),i.Rectangle.pack(n._rectangle,a,o),o+=i.Rectangle.packedLength,t.Ellipsoid.pack(n._ellipsoid,a,o),o+=t.Ellipsoid.packedLength,a[o++]=n._granularity,a[o++]=n._surfaceHeight,a[o++]=n._rotation,a[o++]=n._extrudedHeight,a[o]=e.defaultValue(n._offsetAttribute,-1),a};let G=new i.Rectangle,R=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),P={rectangle:G,ellipsoid:R,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};A.unpack=function(n,a,o){a=e.defaultValue(a,0);let r=i.Rectangle.unpack(n,a,G);a+=i.Rectangle.packedLength;let l=t.Ellipsoid.unpack(n,a,R);a+=t.Ellipsoid.packedLength;let u=n[a++],s=n[a++],d=n[a++],p=n[a++],c=n[a];return e.defined(o)?(o._rectangle=i.Rectangle.clone(r,o._rectangle),o._ellipsoid=t.Ellipsoid.clone(l,o._ellipsoid),o._surfaceHeight=s,o._rotation=d,o._extrudedHeight=p,o._offsetAttribute=-1===c?void 0:c,o):(P.granularity=u,P.height=s,P.rotation=d,P.extrudedHeight=p,P.offsetAttribute=-1===c?void 0:c,new A(P))};let L=new t.Cartographic;return A.createGeometry=function(t){let i,r,c;let f=t._rectangle,g=t._ellipsoid,h=p.RectangleGeometryLibrary.computeOptions(f,t._granularity,t._rotation,0,_,L);if(s.CesiumMath.equalsEpsilon(f.north,f.south,s.CesiumMath.EPSILON10)||s.CesiumMath.equalsEpsilon(f.east,f.west,s.CesiumMath.EPSILON10))return;let m=t._surfaceHeight,A=t._extrudedHeight;if(s.CesiumMath.equalsEpsilon(m,A,0,s.CesiumMath.EPSILON2)){if((i=E(t,h)).attributes.position.values=d.PolygonPipeline.scaleToGeodeticHeight(i.attributes.position.values,m,g,!1),e.defined(t._offsetAttribute)){let e=i.attributes.position.values.length;c=t._offsetAttribute===l.GeometryOffsetAttribute.NONE?0:1;let n=new Uint8Array(e/3).fill(c);i.attributes.applyOffset=new o.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}r=n.BoundingSphere.fromRectangle3D(f,g,m)}else{if(i=function(e,t){let i=e._surfaceHeight,n=e._extrudedHeight,a=e._ellipsoid,o=E(e,t),r=t.height,l=t.width,s=d.PolygonPipeline.scaleToGeodeticHeight(o.attributes.position.values,i,a,!1),p=s.length,c=new Float64Array(2*p);c.set(s);let f=d.PolygonPipeline.scaleToGeodeticHeight(o.attributes.position.values,n,a);c.set(f,p),o.attributes.position.values=c;let g=t.northCap,h=t.southCap,y=4;g&&(y-=1),h&&(y-=1);let b=2*(c.length/3+y),m=u.IndexDatatype.createTypedArray(c.length/3,b);p=c.length/6;let _,A=0;for(let e=0;e<p-1;e++)m[A++]=e,m[A++]=e+1,m[A++]=e+p,m[A++]=e+p+1;if(m[A++]=p-1,m[A++]=0,m[A++]=p+p-1,m[A++]=p,m[A++]=0,m[A++]=p,g)_=r-1;else{let e=l-1;m[A++]=e,m[A++]=e+p,_=l+r-2}if(m[A++]=_,m[A++]=_+p,!h){let e=l+_-1;m[A++]=e,m[A]=e+p}return o.indices=m,o}(t,h),e.defined(t._offsetAttribute)){let e=i.attributes.position.values.length/3,n=new Uint8Array(e);t._offsetAttribute===l.GeometryOffsetAttribute.TOP?n=n.fill(1,0,e/2):(c=t._offsetAttribute===l.GeometryOffsetAttribute.NONE?0:1,n=n.fill(c)),i.attributes.applyOffset=new o.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}let s=n.BoundingSphere.fromRectangle3D(f,g,m,b),p=n.BoundingSphere.fromRectangle3D(f,g,A,y);r=n.BoundingSphere.union(s,p)}return new o.Geometry({attributes:i.attributes,indices:i.indices,primitiveType:o.PrimitiveType.LINES,boundingSphere:r,offsetAttribute:t._offsetAttribute})},function(n,a){return e.defined(a)&&(n=A.unpack(n,a)),n._ellipsoid=t.Ellipsoid.clone(n._ellipsoid),n._rectangle=i.Rectangle.clone(n._rectangle),A.createGeometry(n)}});